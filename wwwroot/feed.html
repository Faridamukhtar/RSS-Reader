<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TurboFeeds</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="/site.css" rel="stylesheet">
    <script src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"></script>
</head>
<body id="entire-page">
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white mb-0">
        <div class="container">
            <a class="navbar-brand pointer">Turbo<em class="em-purple">Feeds</em></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="navbar-collapse collapse d-lg-flex justify-content-end">
                <ul class="navbar-nav" id="nav-links">
                    <li>
                        <form id="logoutForm" hx-post="/logout" hx-target="#entire-page" hx-trigger="submit">
                            <button type="submit" class="btn btn-danger">Logout</button>
                        </form>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="d-flex flex-column flex-lg-row">
        <!-- Top bar for mobile -->
        <div class="topbar d-lg-none p-4">
            <h2 class="font-weight-bold">Active Feeds</h2>
            <br />
            <ul id="feed-list-mobile" class="d-flex justify-content-start" hx-get="/feeds" hx-target="#feed-list-mobile" hx-trigger="load">
                <!-- Feed items will be loaded dynamically here -->
            </ul>
            <br />
            <div class="mt-3 d-flex justify-content-between">
                <button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addFeedModal">Add Feed</button>
                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#removeFeedModal">Remove Feed</button>
            </div>
        </div>

        <!-- Sidebar for larger screens -->
        <div class="sidebar d-none d-lg-block">
            <h2 class="font-weight-bold ml-2">Active Feeds</h2>
            <br/>
            <ul id="feed-list" hx-get="/feeds" hx-target="#feed-list" hx-trigger="load">
                <!-- Feed items will be loaded dynamically here -->
            </ul>
            <br/>
            <div class="mt-3">
                <button type="button" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#addFeedModal">Add Feed</button>
                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#removeFeedModal">Remove Feed</button>
            </div>
        </div>

        <div class="p-4">
            <div class="header">
                <h1 id="header-large"><em class="em-black">Turbo</em><em class="em-purple">Feeds</em></h1>
            </div>
            <div id="feed-content">
                <!-- Feed content will be loaded dynamically here -->
            </div>
        </div>
    </div>

    <!-- Add Feed Modal -->
    <div class="modal fade" id="addFeedModal" tabindex="-1" aria-labelledby="addFeedModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addFeedModalLabel">Add New Feed</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addFeedForm" hx-post="/add-feed" hx-target="#entire-page" hx-swap="outerHTML" hx-trigger="submit">
                        <div class="mb-3">
                            <label for="feedUrl" class="form-label">Feed URL</label>
                            <input type="url" class="form-control" id="feedUrl" name="feedUrl" placeholder="Enter feed URL" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Add</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Remove Feed Modal -->
    <div class="modal fade" id="removeFeedModal" tabindex="-1" aria-labelledby="removeFeedModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="removeFeedModalLabel">Remove</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="removeFeedForm" hx-post="/remove-feed" hx-target="#entire-page" hx-swap="outerHTML" hx-trigger="submit">
                        <div class="mb-3">
                            <label for="feedUrlToRemove" class="form-label">Select Feed to Remove</label>
                            <select class="form-select" id="feedUrlToRemove" name="feedUrlToRemove" hx-get="/feeds-to-remove" hx-target="#feedUrlToRemove" hx-trigger="load">
                                <option value="">Select feed to remove</option>
                                <!-- Options populated dynamically by HTMX -->
                            </select>
                        </div>
                        <button type="submit" class="btn btn-danger">Remove Feed</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2024 - <em class="em-black">Turbo</em><em class="em-purple">Feeds</em>
        </div>
    </footer>
    <script src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>
